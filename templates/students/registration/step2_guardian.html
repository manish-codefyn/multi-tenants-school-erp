{% extends 'layouts/dashboard.html' %}
{% load i18n crispy_forms_tags %}

{% block title %}{% trans "Register New Student - Step 2" %}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-xl-10 col-lg-11">
        <!-- Stepper Partial -->
        {% include 'students/partials/registration_stepper.html' with step=2 %}

        <div class="card border-0 shadow-lg rounded-3 overflow-hidden">
             <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center border-bottom">
                <h5 class="card-title mb-0 fw-bold text-primary"><i class="fas fa-user-shield me-2"></i>{% trans "Guardian Information" %}</h5>
                <span class="badge bg-info bg-opacity-10 text-info border border-info rounded-pill px-3">{% trans "Required" %}</span>
            </div>
            <div class="card-body p-4 p-md-5">
                <form method="post">
                    {% csrf_token %}

                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-info-circle me-2"></i>{% trans "Basic Details" %}</h6>
                    <div class="row g-3 mb-4">
                         <div class="col-md-6">
                            {{ form.full_name|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.relation|as_crispy_field }}
                        </div>
                         <div class="col-md-6">
                            {{ form.date_of_birth|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.occupation|as_crispy_field }}
                        </div>
                    </div>

                    <hr class="text-muted opacity-25 my-4">

                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-address-book me-2"></i>{% trans "Contact Details" %}</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            {{ form.email|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.phone_primary|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.phone_secondary|as_crispy_field }}
                        </div>
                         <div class="col-md-6">
                            {{ form.qualification|as_crispy_field }}
                        </div>
                    </div>

                    <hr class="text-muted opacity-25 my-4">

                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-briefcase me-2"></i>{% trans "Employment & Identification" %}</h6>
                     <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            {{ form.company_name|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                            {{ form.designation|as_crispy_field }}
                        </div>
                         <div class="col-md-4">
                            {{ form.annual_income|as_crispy_field }}
                        </div>
                         <div class="col-md-6">
                            {{ form.aadhaar_number|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.pan_number|as_crispy_field }}
                        </div>
                    </div>

                     <div class="card bg-light border-0 p-3 mb-3">
                        <div class="row">
                            <div class="col-md-4">
                                {{ form.is_primary|as_crispy_field }}
                            </div>
                            <div class="col-md-4">
                                {{ form.is_emergency_contact|as_crispy_field }}
                            </div>
                            <div class="col-md-4">
                                {{ form.can_pickup|as_crispy_field }}
                            </div>
                        </div>
                    </div>

                    <!-- Render remaining fields -->
                     {% for field in form %}
                        {% if field.name not in "full_name,relation,date_of_birth,occupation,email,phone_primary,phone_secondary,qualification,company_name,designation,annual_income,aadhaar_number,pan_number,is_primary,is_emergency_contact,can_pickup,student" %}
                             {{ field|as_crispy_field }}
                        {% endif %}
                    {% endfor %}
                    
                    <div class="d-flex justify-content-between mt-5 pt-3 border-top">
                        <a href="{% url 'students:registration_step1' %}" class="btn btn-outline-secondary btn-lg px-4">
                            <i class="fas fa-arrow-left ms-2"></i> {% trans "Back" %}
                        </a> 
                        <!-- Note: Going back to step1 creates specific issues with 'Update' vs 'Create', 
                             IDEALLY step1 URL should be creating a new one or updating if cookie set, 
                             But for now user requested flow is linear.
                             Actually, better to link to Update view of the student if we have ID. -->
                             
                        <button type="submit" class="btn btn-primary btn-lg px-5 shadow-sm">
                            {% trans "Next: Documents" %} <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
