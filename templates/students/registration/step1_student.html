{% extends 'layouts/dashboard.html' %}
{% load i18n crispy_forms_tags %}

{% block title %}{% trans "Register New Student - Step 1" %}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-xl-10 col-lg-11">
        <!-- Stepper Partial -->
        {% include 'students/partials/registration_stepper.html' with step=1 %}

        <div class="card border-0 shadow-lg rounded-3 overflow-hidden">
            <div class="card-header bg-primary text-white py-3">
                <h5 class="card-title mb-0 fw-bold"><i class="fas fa-user-graduate me-2"></i>{% trans "Student Basic Information" %}</h5>
            </div>
            <div class="card-body p-4 p-md-5">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <!-- Section: Personal Details -->
                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-id-card me-2"></i>{% trans "Personal Details" %}</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            {{ form.first_name|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                            {{ form.middle_name|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                            {{ form.last_name|as_crispy_field }}
                        </div>

                        <div class="col-md-4">
                            {{ form.date_of_birth|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                            {{ form.gender|as_crispy_field }}
                        </div>
                         <div class="col-md-4">
                            {{ form.blood_group|as_crispy_field }}
                        </div>
                        
                        <div class="col-md-3">
                            {{ form.nationality|as_crispy_field }}
                        </div>
                        <div class="col-md-3">
                            {{ form.marital_status|as_crispy_field }}
                        </div>
                        <div class="col-md-3">
                            {{ form.category|as_crispy_field }}
                        </div>
                        <div class="col-md-3">
                             {{ form.religion|as_crispy_field }}
                        </div>
                    </div>

                    <hr class="text-muted opacity-25 my-4">

                    <!-- Section: Contact Information -->
                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-address-book me-2"></i>{% trans "Contact Information" %}</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            {{ form.personal_email|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                             {{ form.institutional_email|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.mobile_primary|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.mobile_secondary|as_crispy_field }}
                        </div>
                    </div>

                    <hr class="text-muted opacity-25 my-4">

                    <!-- Section: Academic Details -->
                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-university me-2"></i>{% trans "Academic Details" %}</h6>
                     <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            {{ form.admission_type|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                            {{ form.enrollment_date|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                             {{ form.academic_year|as_crispy_field }}
                        </div>

                         <div class="col-md-4">
                            {{ form.current_class|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                            {{ form.section|as_crispy_field }}
                        </div>
                        <div class="col-md-4">
                             {{ form.roll_number|as_crispy_field }}
                        </div>
                         <div class="col-md-6">
                             {{ form.reg_no|as_crispy_field }}
                         </div>
                    </div>

                    <hr class="text-muted opacity-25 my-4">

                    <!-- Section: Additional Info -->
                    <h6 class="text-primary fw-bold mb-3 text-uppercase small ls-1"><i class="fas fa-info-circle me-2"></i>{% trans "Additional Information" %}</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                             {{ form.annual_family_income|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            <!-- Checkboxes -->
                            <div class="card bg-light border-0 p-3">
                                {{ form.is_minority|as_crispy_field }}
                                {{ form.is_physically_challenged|as_crispy_field }}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Hidden or non-layout fields -->
                    {% for field in form %}
                        {% if field.name not in "first_name,middle_name,last_name,date_of_birth,gender,blood_group,nationality,marital_status,category,religion,personal_email,institutional_email,mobile_primary,mobile_secondary,admission_type,enrollment_date,academic_year,current_class,section,roll_number,reg_no,annual_family_income,is_minority,is_physically_challenged" %}
                             {{ field|as_crispy_field }}
                        {% endif %}
                    {% endfor %}

                    
                    <div class="d-flex justify-content-end mt-5 pt-3 border-top">
                        <a href="{% url 'students:student_list' %}" class="btn btn-light btn-lg me-3 px-4">{% trans "Cancel" %}</a>
                        <button type="submit" class="btn btn-primary btn-lg px-5 shadow-sm">
                            {% trans "Next: Guardian Details" %} <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
    .ls-1 { letter-spacing: 1px; }
    .form-control:focus, .form-select:focus {
        border-color: var(--bs-primary);
        box-shadow: 0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.15);
    }
</style>
{% endblock %}
