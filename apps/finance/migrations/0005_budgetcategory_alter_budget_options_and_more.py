# Generated by Django 4.2.7 on 2025-12-17 05:33

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    dependencies = [
        ('tenants', '0002_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('academics', '0002_initial'),
        ('finance', '0004_alter_expense_supporting_documents_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='BudgetCategory',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('name', models.CharField(help_text="Enter category name (e.g., 'Salaries', 'Infrastructure')", max_length=100, verbose_name='Category Name')),
                ('code', models.CharField(help_text="Short code for category (e.g., 'SAL', 'INFRA')", max_length=20, unique=True, verbose_name='Category Code')),
                ('category_type', models.CharField(choices=[('INCOME', 'Income'), ('EXPENSE', 'Expense'), ('CAPITAL', 'Capital Expenditure'), ('REVENUE', 'Revenue Expenditure')], default='EXPENSE', help_text='Type of budget category', max_length=20, verbose_name='Category Type')),
                ('description', models.TextField(blank=True, help_text='Description of what this category includes', verbose_name='Description')),
                ('is_active', models.BooleanField(default=True, help_text='Uncheck to deactivate this category', verbose_name='Is Active')),
                ('display_order', models.PositiveIntegerField(default=0, help_text='Order in which categories appear in lists', verbose_name='Display Order')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='Deleted By')),
                ('parent_category', models.ForeignKey(blank=True, help_text='Select parent category if this is a sub-category', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='sub_categories', to='finance.budgetcategory', verbose_name='Parent Category')),
                ('tenant', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_records', to='tenants.tenant', verbose_name='Owning Tenant')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Last Modified By')),
            ],
            options={
                'verbose_name': 'Budget Category',
                'verbose_name_plural': 'Budget Categories',
                'db_table': 'finance_budget_categories',
                'ordering': ['display_order', 'name'],
            },
        ),
        migrations.AlterModelOptions(
            name='budget',
            options={'ordering': ['-academic_year', 'name'], 'permissions': [('can_approve_budget', 'Can approve budgets'), ('can_activate_budget', 'Can activate budgets'), ('can_submit_budget', 'Can submit budgets for approval')], 'verbose_name': 'Budget', 'verbose_name_plural': 'Budgets'},
        ),
        migrations.RemoveField(
            model_name='budget',
            name='budget_items',
        ),
        migrations.RemoveField(
            model_name='budget',
            name='is_active',
        ),
        migrations.AddField(
            model_name='budget',
            name='budget_type',
            field=models.CharField(choices=[('ACADEMIC', 'Academic Budget'), ('OPERATIONAL', 'Operational Budget'), ('DEVELOPMENT', 'Development Budget'), ('SPECIAL', 'Special Projects Budget'), ('ANNUAL', 'Annual Budget')], default='ANNUAL', help_text='Select the type of budget', max_length=20, verbose_name='Budget Type'),
        ),
        migrations.AddField(
            model_name='budget',
            name='last_reviewed',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Last Reviewed'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='academic_year',
            field=models.ForeignKey(help_text='Select the academic year this budget applies to', on_delete=django.db.models.deletion.CASCADE, related_name='budgets', to='academics.academicyear', verbose_name='Academic Year'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='approval_date',
            field=models.DateTimeField(blank=True, help_text='Date when budget was approved', null=True, verbose_name='Approval Date'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='approved_by',
            field=models.ForeignKey(blank=True, help_text='User who approved this budget', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_budgets', to=settings.AUTH_USER_MODEL, verbose_name='Approved By'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='end_date',
            field=models.DateField(help_text='Budget end date (format: YYYY-MM-DD)', verbose_name='End Date'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='name',
            field=models.CharField(help_text="Enter a descriptive name (e.g., 'Academic Year 2024-25 Operating Budget')", max_length=200, verbose_name='Budget Name'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='notes',
            field=models.TextField(blank=True, help_text='Additional notes or comments about this budget', verbose_name='Notes'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='prepared_by',
            field=models.ForeignKey(help_text='User who created this budget', on_delete=django.db.models.deletion.CASCADE, related_name='prepared_budgets', to=settings.AUTH_USER_MODEL, verbose_name='Prepared By'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='start_date',
            field=models.DateField(help_text='Budget start date (format: YYYY-MM-DD)', verbose_name='Start Date'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='status',
            field=models.CharField(choices=[('DRAFT', 'üìù Draft'), ('SUBMITTED', 'üì§ Submitted for Approval'), ('APPROVED', '‚úÖ Approved'), ('ACTIVE', '‚ñ∂Ô∏è Active'), ('CLOSED', 'üîí Closed')], default='DRAFT', help_text='Current status of the budget', max_length=20, verbose_name='Status'),
        ),
        migrations.AlterField(
            model_name='budget',
            name='total_amount',
            field=models.DecimalField(decimal_places=2, help_text='Total allocated budget amount in ‚Çπ', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Total Budget Amount'),
        ),
        migrations.CreateModel(
            name='BudgetTemplateItem',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='False indicates the record has been soft deleted', verbose_name='Active Status')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('description', models.CharField(max_length=500, verbose_name='Description')),
                ('default_amount', models.DecimalField(decimal_places=2, help_text='Default amount for this item in templates', max_digits=12, verbose_name='Default Amount')),
                ('is_fixed', models.BooleanField(default=False)),
                ('is_discretionary', models.BooleanField(default=False)),
                ('priority', models.IntegerField(choices=[(1, 'High'), (2, 'Medium'), (3, 'Low')], default=2)),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='finance.budgetcategory', verbose_name='Category')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='Deleted By')),
                ('tenant', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_records', to='tenants.tenant', verbose_name='Owning Tenant')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Last Modified By')),
            ],
            options={
                'verbose_name': 'Budget Template Item',
                'verbose_name_plural': 'Budget Template Items',
                'db_table': 'finance_budget_template_items',
            },
        ),
        migrations.CreateModel(
            name='BudgetTemplate',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('name', models.CharField(help_text='Name of the budget template', max_length=200, verbose_name='Template Name')),
                ('description', models.TextField(blank=True, help_text='Description of when to use this template', verbose_name='Description')),
                ('budget_type', models.CharField(choices=[('ACADEMIC', 'Academic Budget'), ('OPERATIONAL', 'Operational Budget'), ('DEVELOPMENT', 'Development Budget'), ('SPECIAL', 'Special Projects Budget'), ('ANNUAL', 'Annual Budget')], max_length=20, verbose_name='Budget Type')),
                ('is_active', models.BooleanField(default=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='Deleted By')),
                ('template_items', models.ManyToManyField(help_text='Select items to include in this template', related_name='templates', to='finance.budgettemplateitem', verbose_name='Template Items')),
                ('tenant', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_records', to='tenants.tenant', verbose_name='Owning Tenant')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Last Modified By')),
            ],
            options={
                'verbose_name': 'Budget Template',
                'verbose_name_plural': 'Budget Templates',
                'db_table': 'finance_budget_templates',
            },
        ),
        migrations.CreateModel(
            name='BudgetItem',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='False indicates the record has been soft deleted', verbose_name='Active Status')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('description', models.CharField(help_text='Detailed description of this budget item', max_length=500, verbose_name='Description')),
                ('allocated_amount', models.DecimalField(decimal_places=2, help_text='Amount allocated for this item in ‚Çπ', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Allocated Amount')),
                ('january', models.DecimalField(decimal_places=2, default=0, help_text='Amount allocated for January', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='January')),
                ('february', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='February')),
                ('march', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='March')),
                ('april', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='April')),
                ('may', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='May')),
                ('june', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='June')),
                ('july', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='July')),
                ('august', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='August')),
                ('september', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='September')),
                ('october', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='October')),
                ('november', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='November')),
                ('december', models.DecimalField(decimal_places=2, default=0, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='December')),
                ('is_fixed', models.BooleanField(default=False, help_text='Check if this is a fixed/regular cost', verbose_name='Is Fixed Cost')),
                ('is_discretionary', models.BooleanField(default=False, help_text='Check if this expense is discretionary/optional', verbose_name='Is Discretionary')),
                ('priority', models.IntegerField(choices=[(1, 'High'), (2, 'Medium'), (3, 'Low')], default=2, help_text='Priority level for this budget item', verbose_name='Priority')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about this budget item', verbose_name='Notes')),
                ('display_order', models.PositiveIntegerField(default=0, verbose_name='Display Order')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('budget', models.ForeignKey(help_text='Select the budget this item belongs to', on_delete=django.db.models.deletion.CASCADE, related_name='budget_items', to='finance.budget', verbose_name='Budget')),
                ('category', models.ForeignKey(help_text='Select budget category for this item', on_delete=django.db.models.deletion.PROTECT, related_name='budget_items', to='finance.budgetcategory', verbose_name='Category')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='Deleted By')),
                ('expense_record', models.ForeignKey(blank=True, help_text='Link to actual expense record if applicable', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='budget_items', to='finance.expense', verbose_name='Expense Record')),
                ('tenant', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_records', to='tenants.tenant', verbose_name='Owning Tenant')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Last Modified By')),
            ],
            options={
                'verbose_name': 'Budget Item',
                'verbose_name_plural': 'Budget Items',
                'db_table': 'finance_budget_items',
                'ordering': ['display_order', 'category__name'],
            },
        ),
    ]
