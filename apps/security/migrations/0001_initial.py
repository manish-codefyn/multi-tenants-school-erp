# Generated by Django 4.2.7 on 2025-12-13 04:15

from django.db import migrations, models
import django.utils.timezone
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='AccessControlPolicy',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('name', models.CharField(max_length=100, verbose_name='Policy Name')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('ip_whitelist', models.JSONField(blank=True, default=list, help_text='List of allowed IP addresses/CIDR ranges', verbose_name='IP Whitelist')),
                ('ip_blacklist', models.JSONField(blank=True, default=list, help_text='List of blocked IP addresses/CIDR ranges', verbose_name='IP Blacklist')),
                ('allowed_access_hours', models.JSONField(blank=True, default=dict, help_text="JSON: {'start': '09:00', 'end': '17:00', 'days': [0,1,2,3,4]}", verbose_name='Allowed Access Hours')),
                ('allowed_countries', models.JSONField(blank=True, default=list, help_text='List of allowed country codes', verbose_name='Allowed Countries')),
                ('blocked_countries', models.JSONField(blank=True, default=list, help_text='List of blocked country codes', verbose_name='Blocked Countries')),
                ('allowed_user_agents', models.JSONField(blank=True, default=list, help_text='List of allowed user agent patterns', verbose_name='Allowed User Agents')),
                ('require_secure_connection', models.BooleanField(default=True, verbose_name='Require HTTPS')),
                ('apply_to_roles', models.JSONField(default=list, help_text='List of roles this policy applies to', verbose_name='Apply to Roles')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
            ],
            options={
                'verbose_name': 'Access Control Policy',
                'verbose_name_plural': 'Access Control Policies',
                'db_table': 'security_access_control_policies',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='False indicates the record has been soft deleted', verbose_name='Active Status')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('event_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True, verbose_name='Event ID')),
                ('event_type', models.CharField(max_length=100, verbose_name='Event Type')),
                ('event_category', models.CharField(choices=[('AUTHENTICATION', 'Authentication'), ('AUTHORIZATION', 'Authorization'), ('USER_MANAGEMENT', 'User Management'), ('DATA_ACCESS', 'Data Access'), ('CONFIGURATION', 'Configuration Change'), ('SYSTEM', 'System Event'), ('SECURITY', 'Security Incident'), ('COMPLIANCE', 'Compliance')], max_length=20, verbose_name='Event Category')),
                ('description', models.TextField(verbose_name='Description')),
                ('severity', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], default='MEDIUM', max_length=10, verbose_name='Severity')),
                ('outcome', models.CharField(choices=[('SUCCESS', 'Success'), ('FAILURE', 'Failure'), ('WARNING', 'Warning'), ('UNKNOWN', 'Unknown')], default='UNKNOWN', max_length=10, verbose_name='Outcome')),
                ('user_role', models.CharField(blank=True, max_length=20, verbose_name='User Role')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP Address')),
                ('user_agent', models.TextField(blank=True, verbose_name='User Agent')),
                ('request_method', models.CharField(blank=True, max_length=10, verbose_name='HTTP Method')),
                ('request_path', models.TextField(blank=True, verbose_name='Request Path')),
                ('resource_type', models.CharField(blank=True, max_length=100, verbose_name='Resource Type')),
                ('resource_id', models.CharField(blank=True, max_length=100, verbose_name='Resource ID')),
                ('resource_name', models.CharField(blank=True, max_length=200, verbose_name='Resource Name')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='Metadata')),
                ('correlation_id', models.UUIDField(blank=True, null=True, verbose_name='Correlation ID')),
            ],
            options={
                'verbose_name': 'Audit Log',
                'verbose_name_plural': 'Audit Logs',
                'db_table': 'security_audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='IncidentTimeline',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='False indicates the record has been soft deleted', verbose_name='Active Status')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('event_type', models.CharField(choices=[('DETECTED', 'Detected'), ('REPORTED', 'Reported'), ('ASSIGNED', 'Assigned'), ('INVESTIGATION_STARTED', 'Investigation Started'), ('EVIDENCE_COLLECTED', 'Evidence Collected'), ('CONTAINED', 'Contained'), ('RESOLVED', 'Resolved'), ('CLOSED', 'Closed'), ('NOTE', 'Note'), ('OTHER', 'Other')], max_length=25, verbose_name='Event Type')),
                ('description', models.TextField(verbose_name='Description')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='Metadata')),
            ],
            options={
                'verbose_name': 'Incident Timeline Event',
                'verbose_name_plural': 'Incident Timeline Events',
                'db_table': 'security_incident_timeline',
                'ordering': ['incident', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='PasswordPolicy',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('name', models.CharField(max_length=100, verbose_name='Policy Name')),
                ('min_length', models.PositiveIntegerField(default=8, verbose_name='Minimum Length')),
                ('require_uppercase', models.BooleanField(default=True, verbose_name='Require Uppercase')),
                ('require_lowercase', models.BooleanField(default=True, verbose_name='Require Lowercase')),
                ('require_numbers', models.BooleanField(default=True, verbose_name='Require Numbers')),
                ('require_special_chars', models.BooleanField(default=True, verbose_name='Require Special Characters')),
                ('min_special_chars', models.PositiveIntegerField(default=1, verbose_name='Minimum Special Characters')),
                ('prevent_reuse', models.BooleanField(default=True, verbose_name='Prevent Password Reuse')),
                ('password_history_size', models.PositiveIntegerField(default=5, verbose_name='Password History Size')),
                ('password_expiry_days', models.PositiveIntegerField(default=90, verbose_name='Password Expiry (days)')),
                ('warn_before_expiry', models.PositiveIntegerField(default=7, verbose_name='Warn Before Expiry (days)')),
                ('max_login_attempts', models.PositiveIntegerField(default=5, verbose_name='Maximum Login Attempts')),
                ('lockout_duration_minutes', models.PositiveIntegerField(default=30, verbose_name='Lockout Duration (minutes)')),
                ('require_mfa', models.BooleanField(default=False, verbose_name='Require MFA')),
                ('mfa_methods', models.JSONField(default=list, help_text="List of allowed MFA methods: ['TOTP', 'SMS', 'EMAIL']", verbose_name='Allowed MFA Methods')),
                ('apply_to_students', models.BooleanField(default=True, verbose_name='Apply to Students')),
                ('apply_to_staff', models.BooleanField(default=True, verbose_name='Apply to Staff')),
                ('apply_to_admins', models.BooleanField(default=True, verbose_name='Apply to Administrators')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
            ],
            options={
                'verbose_name': 'Password Policy',
                'verbose_name_plural': 'Password Policies',
                'db_table': 'security_password_policies',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='SecurityIncident',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='False indicates the record has been soft deleted', verbose_name='Active Status')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('incident_id', models.CharField(db_index=True, max_length=50, unique=True, verbose_name='Incident ID')),
                ('title', models.CharField(max_length=200, verbose_name='Incident Title')),
                ('incident_type', models.CharField(choices=[('UNAUTHORIZED_ACCESS', 'Unauthorized Access'), ('DATA_BREACH', 'Data Breach'), ('MALWARE', 'Malware Infection'), ('PHISHING', 'Phishing Attack'), ('DOS', 'Denial of Service'), ('BRUTE_FORCE', 'Brute Force Attack'), ('SUSPICIOUS_ACTIVITY', 'Suspicious Activity'), ('POLICY_VIOLATION', 'Policy Violation'), ('OTHER', 'Other')], max_length=30, verbose_name='Incident Type')),
                ('description', models.TextField(verbose_name='Description')),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], default='MEDIUM', max_length=10, verbose_name='Priority')),
                ('status', models.CharField(choices=[('OPEN', 'Open'), ('UNDER_INVESTIGATION', 'Under Investigation'), ('CONTAINED', 'Contained'), ('RESOLVED', 'Resolved'), ('CLOSED', 'Closed')], default='OPEN', max_length=25, verbose_name='Status')),
                ('detected_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Detected At')),
                ('reported_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Reported At')),
                ('contained_at', models.DateTimeField(blank=True, null=True, verbose_name='Contained At')),
                ('resolved_at', models.DateTimeField(blank=True, null=True, verbose_name='Resolved At')),
                ('impact_level', models.CharField(choices=[('MINIMAL', 'Minimal'), ('MODERATE', 'Moderate'), ('MAJOR', 'Major'), ('SEVERE', 'Severe')], default='MODERATE', max_length=20, verbose_name='Impact Level')),
                ('affected_systems', models.JSONField(blank=True, default=list, verbose_name='Affected Systems')),
                ('data_compromised', models.BooleanField(default=False, verbose_name='Data Compromised')),
                ('data_compromised_details', models.TextField(blank=True, verbose_name='Data Compromised Details')),
                ('root_cause', models.TextField(blank=True, verbose_name='Root Cause')),
                ('action_taken', models.TextField(blank=True, verbose_name='Action Taken')),
                ('prevention_measures', models.TextField(blank=True, verbose_name='Prevention Measures')),
                ('regulatory_report_required', models.BooleanField(default=False, verbose_name='Regulatory Report Required')),
                ('regulatory_body', models.CharField(blank=True, max_length=100, verbose_name='Regulatory Body')),
                ('attachments', models.JSONField(blank=True, default=list, verbose_name='Attachments')),
                ('notes', models.TextField(blank=True, verbose_name='Notes')),
            ],
            options={
                'verbose_name': 'Security Incident',
                'verbose_name_plural': 'Security Incidents',
                'db_table': 'security_incidents',
                'ordering': ['-detected_at'],
            },
        ),
        migrations.CreateModel(
            name='SecurityPolicy',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('name', models.CharField(max_length=200, verbose_name='Policy Name')),
                ('policy_type', models.CharField(choices=[('PASSWORD', 'Password Policy'), ('SESSION', 'Session Policy'), ('ACCESS', 'Access Control Policy'), ('AUDIT', 'Audit Policy'), ('NETWORK', 'Network Security Policy'), ('DATA', 'Data Protection Policy'), ('COMPLIANCE', 'Compliance Policy')], max_length=20, verbose_name='Policy Type')),
                ('code', models.CharField(max_length=50, unique=True, verbose_name='Policy Code')),
                ('description', models.TextField(verbose_name='Description')),
                ('policy_document', models.TextField(verbose_name='Policy Document')),
                ('version', models.CharField(default='1.0', max_length=20, verbose_name='Version')),
                ('is_mandatory', models.BooleanField(default=True, verbose_name='Is Mandatory')),
                ('enforcement_level', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], default='MEDIUM', max_length=20, verbose_name='Enforcement Level')),
                ('compliance_standard', models.CharField(blank=True, max_length=100, verbose_name='Compliance Standard')),
                ('requires_acknowledgement', models.BooleanField(default=True, verbose_name='Requires User Acknowledgement')),
                ('effective_date', models.DateField(default=django.utils.timezone.now, verbose_name='Effective Date')),
                ('expiry_date', models.DateField(blank=True, null=True, verbose_name='Expiry Date')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
            ],
            options={
                'verbose_name': 'Security Policy',
                'verbose_name_plural': 'Security Policies',
                'db_table': 'security_policies',
                'ordering': ['policy_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='SecurityScan',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='False indicates the record has been soft deleted', verbose_name='Active Status')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('scan_id', models.CharField(db_index=True, max_length=50, unique=True, verbose_name='Scan ID')),
                ('scan_type', models.CharField(choices=[('VULNERABILITY', 'Vulnerability Scan'), ('COMPLIANCE', 'Compliance Scan'), ('PENETRATION_TEST', 'Penetration Test'), ('CODE_REVIEW', 'Code Review'), ('CONFIGURATION', 'Configuration Audit')], max_length=20, verbose_name='Scan Type')),
                ('target', models.CharField(max_length=500, verbose_name='Target')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('parameters', models.JSONField(blank=True, default=dict, verbose_name='Scan Parameters')),
                ('scheduled_at', models.DateTimeField(verbose_name='Scheduled At')),
                ('started_at', models.DateTimeField(blank=True, null=True, verbose_name='Started At')),
                ('completed_at', models.DateTimeField(blank=True, null=True, verbose_name='Completed At')),
                ('status', models.CharField(choices=[('SCHEDULED', 'Scheduled'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('FAILED', 'Failed'), ('CANCELLED', 'Cancelled')], default='SCHEDULED', max_length=15, verbose_name='Status')),
                ('findings_count', models.PositiveIntegerField(default=0, verbose_name='Findings Count')),
                ('critical_findings', models.PositiveIntegerField(default=0, verbose_name='Critical Findings')),
                ('high_findings', models.PositiveIntegerField(default=0, verbose_name='High Findings')),
                ('scan_report', models.FileField(blank=True, null=True, upload_to='security/scans/reports/', verbose_name='Scan Report')),
                ('scanner', models.CharField(blank=True, max_length=100, verbose_name='Scanner Tool')),
            ],
            options={
                'verbose_name': 'Security Scan',
                'verbose_name_plural': 'Security Scans',
                'db_table': 'security_scans',
                'ordering': ['-scheduled_at'],
            },
        ),
        migrations.CreateModel(
            name='SessionPolicy',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('name', models.CharField(max_length=100, verbose_name='Policy Name')),
                ('session_timeout_minutes', models.PositiveIntegerField(default=30, verbose_name='Session Timeout (minutes)')),
                ('extend_session_on_activity', models.BooleanField(default=True, verbose_name='Extend Session on Activity')),
                ('max_concurrent_sessions', models.PositiveIntegerField(default=3, verbose_name='Maximum Concurrent Sessions')),
                ('prevent_concurrent_logins', models.BooleanField(default=False, verbose_name='Prevent Concurrent Logins')),
                ('require_secure_cookies', models.BooleanField(default=True, verbose_name='Require Secure Cookies')),
                ('http_only_cookies', models.BooleanField(default=True, verbose_name='HTTP Only Cookies')),
                ('same_site_cookies', models.CharField(choices=[('LAX', 'Lax'), ('STRICT', 'Strict'), ('NONE', 'None')], default='LAX', max_length=10, verbose_name='SameSite Cookie Policy')),
                ('apply_to_students', models.BooleanField(default=True, verbose_name='Apply to Students')),
                ('apply_to_staff', models.BooleanField(default=True, verbose_name='Apply to Staff')),
                ('apply_to_admins', models.BooleanField(default=True, verbose_name='Apply to Administrators')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
            ],
            options={
                'verbose_name': 'Session Policy',
                'verbose_name_plural': 'Session Policies',
                'db_table': 'security_session_policies',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='ThreatIntelligence',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True, verbose_name='Universal ID')),
                ('data_signature', models.CharField(blank=True, editable=False, max_length=64, verbose_name='Data Integrity Signature')),
                ('encryption_version', models.CharField(default='v1', editable=False, max_length=10, verbose_name='Encryption Scheme Version')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Creation Timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Last Modification Timestamp')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='Deletion Timestamp')),
                ('deletion_reason', models.TextField(blank=True, help_text='Mandatory for compliance: Reason for record deletion', null=True, verbose_name='Deletion Justification')),
                ('deletion_category', models.CharField(blank=True, choices=[('USER_REQUEST', 'User Request'), ('ADMIN_ACTION', 'Administrative Action'), ('SYSTEM_CLEANUP', 'System Cleanup'), ('COMPLIANCE', 'Compliance Requirement'), ('OTHER', 'Other')], max_length=50, null=True, verbose_name='Deletion Category')),
                ('request_count', models.PositiveIntegerField(default=0, verbose_name='API Request Count')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='Last API Request')),
                ('rate_limit_key', models.CharField(blank=True, editable=False, max_length=100, verbose_name='Rate Limit Identifier')),
                ('indicator', models.CharField(max_length=500, unique=True, verbose_name='Indicator')),
                ('indicator_type', models.CharField(choices=[('IP_ADDRESS', 'IP Address'), ('DOMAIN', 'Domain'), ('URL', 'URL'), ('HASH', 'File Hash'), ('EMAIL', 'Email Address'), ('OTHER', 'Other')], max_length=20, verbose_name='Indicator Type')),
                ('threat_type', models.CharField(choices=[('MALWARE', 'Malware'), ('PHISHING', 'Phishing'), ('RANSOMWARE', 'Ransomware'), ('BOTNET', 'Botnet'), ('DDoS', 'DDoS'), ('EXPLOIT', 'Exploit'), ('OTHER', 'Other')], max_length=20, verbose_name='Threat Type')),
                ('description', models.TextField(verbose_name='Description')),
                ('confidence_level', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CONFIRMED', 'Confirmed')], default='MEDIUM', max_length=15, verbose_name='Confidence Level')),
                ('severity', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], default='MEDIUM', max_length=10, verbose_name='Severity')),
                ('source', models.CharField(max_length=200, verbose_name='Source')),
                ('first_seen', models.DateTimeField(default=django.utils.timezone.now, verbose_name='First Seen')),
                ('last_seen', models.DateTimeField(blank=True, null=True, verbose_name='Last Seen')),
                ('valid_until', models.DateTimeField(blank=True, null=True, verbose_name='Valid Until')),
                ('tags', models.JSONField(blank=True, default=list, verbose_name='Tags')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='Metadata')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
            ],
            options={
                'verbose_name': 'Threat Intelligence',
                'verbose_name_plural': 'Threat Intelligence',
                'db_table': 'security_threat_intelligence',
                'ordering': ['-first_seen'],
            },
        ),
    ]
